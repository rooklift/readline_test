<!DOCTYPE html>
<html>
<head><title>Electron Readline Test</title></head>
<body>
	<p id="para">Running...</p>
</body>
<script>

	const child_process = require("child_process");
	const path = require("path");
	const readline = require("readline");

	function try_n(n) {

		let exe = child_process.spawn(
			path.join(__dirname, "testprog.exe"),
			[n.toString()]
		);

		let scanner = readline.createInterface({
			input: exe.stdout,
			output: undefined,
			terminal: false
		});

		scanner.on("line", (line) => {
			document.getElementById("para").innerHTML += `<br>${n} succeeded. (len: ${line.length}, end: ${line.slice(-6)})`;
			if (n < 50000000) {
				try_n(n + 100000);
			}
		});
	}

	try_n(0);

</script>
</html>
